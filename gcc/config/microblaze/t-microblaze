# For C++ crtstuff
EXTRA_MULTILIB_PARTS = crtbegin$(objext) crtend$(objext)

EXTRA_PARTS += crti$(objext) crtn$(objext)

MULTILIB_OPTIONS = mxl-barrel-shift mno-xl-soft-mul mxl-multiply-high mlittle-endian
MULTILIB_DIRNAMES = bs m mh le
MULTILIB_EXCEPTIONS = *mxl-barrel-shift/mxl-multiply-high mxl-multiply-high
MULTILIB_EXCEPTIONS += *mxl-barrel-shift/mxl-multiply-high/mlittle-endian
MULTILIB_EXCEPTIONS += mxl-multiply-high/mlittle-endian

# Extra files
microblaze-c.o: $(srcdir)/config/microblaze/microblaze-c.c \
    $(srcdir)/config/microblaze/microblaze-protos.h \
    $(CONFIG_H) $(SYSTEM_H) $(CPPLIB_H) $(TM_P_H) $(TREE_H) errors.h $(TM_H)
	$(COMPILER) -c $(ALL_COMPILERFLAGS) $(ALL_CPPFLAGS) $(INCLUDES) \
	$(srcdir)/config/microblaze/microblaze-c.c

# Build soft FP routines. 
FPBIT = fp-bit.c
DPBIT = dp-bit.c

fp-bit.c: $(srcdir)/config/fp-bit.c
	echo '#define FLOAT' > fp-bit.c
	cat $(srcdir)/config/fp-bit.c >> fp-bit.c

dp-bit.c: $(srcdir)/config/fp-bit.c
	cat $(srcdir)/config/fp-bit.c > dp-bit.c

# Assemble startup files
$(T)crti$(objext): $(srcdir)/config/microblaze/crti.s
	$(GCC_FOR_TARGET) $(MULTILIB_CFLAGS) -c $(srcdir)/config/microblaze/crti.s -o $(T)crti$(objext)

$(T)crtn$(objext): $(srcdir)/config/microblaze/crtn.s
	$(GCC_FOR_TARGET) $(MULTILIB_CFLAGS) -c $(srcdir)/config/microblaze/crtn.s -o $(T)crtn$(objext)
